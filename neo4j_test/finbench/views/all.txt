match (n:Account)-[r1*..2]->(m:Loan) where all(rel in r1 where rel.is_view is null) with n,m create (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m)
match (n:Company)-[r1]->()-[r2]->(m:Loan) where r1.is_view is null and r2.is_view is null with n,m create (n)-[r:COMPANY_LOAN{is_view:true}]->(m)
match (n:Person)-[r1*2]->(m:Company) where all(rel in r1 where rel.is_view is null) with n,m create (n)-[r:PERSON_COMPANY{is_view:true}]->(m)