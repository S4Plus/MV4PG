{
    "MATCH (acc:Account {id:\"1694622296319520\"})<-[r:deposit]-(loan: Loan {createTime: \"1656084982460\"}) create (acc)-[r1:repay{timestamp:\"1729822775000\",amount:\"39419373.84\"}]->(loan)": "MATCH (acc:Account {id:\"1694622296319520\"})<-[r:deposit]-(loan: Loan {createTime: \"1656084982460\"}) create (acc)-[r1:repay{timestamp:\"1729822775000\",amount:\"39419373.84\"}]->(loan) WITH [r1] as create_views  UNWIND create_views as view_edge optional match (n:Account)-[ANONR0*0]->()-[view_edge]->()-[ANONR1*0..1]->(m:Loan) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m CREATE (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with DISTINCT view_edge optional match (n:Account)-[ANONR2*1]->()-[view_edge]->()-[ANONR3*0]->(m:Loan) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m CREATE (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with DISTINCT view_edge optional match (n:Company)-[view_edge]->()-[r2]->(m:Loan) WHERE view_edge.is_view is null  AND r2.is_view is null  with n,m CREATE(n)-[r:COMPANY_LOAN{is_view:true}]->(m) with DISTINCT view_edge optional match (n:Company)-[r1]->()-[view_edge]->(m:Loan) WHERE r1.is_view is null  AND view_edge.is_view is null  with n,m CREATE(n)-[r:COMPANY_LOAN{is_view:true}]->(m) with DISTINCT view_edge optional match (n:Person)-[ANONR0*0]->()-[view_edge]->()-[ANONR1*1..1]->(m:Company) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m CREATE (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with DISTINCT view_edge optional match (n:Person)-[ANONR2*1]->()-[view_edge]->()-[ANONR3*0..0]->(m:Company) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m CREATE (n)-[r:PERSON_COMPANY{is_view:true}]->(m)",
    "MATCH (acc:Account {id: \"7606696318861801\"})-[r:repay]->(loan: Loan {id: \"288346924384537\"}) where r.timestamp=\"1645739703489\" delete r": "MATCH (acc:Account {id: \"7606696318861801\"})-[r:repay]->(loan: Loan {id: \"288346924384537\"}) where r.timestamp=\"1645739703489\" WITH [r] as delete_views  UNWIND delete_views as view_edge optional match (n:Account)-[ANONR0*0]->()-[view_edge]->()-[ANONR1*0..1]->(m:Loan) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with view_edges UNWIND view_edges as view_edge with DISTINCT view_edge optional match (n:Account)-[ANONR2*1]->()-[view_edge]->()-[ANONR3*0]->(m:Loan) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with view_edges UNWIND view_edges as view_edge with DISTINCT view_edge optional match (n:Company)-[view_edge]->()-[r2]->(m:Loan) WHERE view_edge.is_view is null  AND r2.is_view is null  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:COMPANY_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with view_edges UNWIND view_edges as view_edge with DISTINCT view_edge optional match (n:Company)-[r1]->()-[view_edge]->(m:Loan) WHERE r1.is_view is null  AND view_edge.is_view is null  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:COMPANY_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with view_edges UNWIND view_edges as view_edge with DISTINCT view_edge optional match (n:Person)-[ANONR0*0]->()-[view_edge]->()-[ANONR1*1..1]->(m:Company) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with view_edges UNWIND view_edges as view_edge with DISTINCT view_edge optional match (n:Person)-[ANONR2*1]->()-[view_edge]->()-[ANONR3*0..0]->(m:Company) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND view_edge.is_view is null  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m,collect(view_edge) as view_edges with n,m,size(view_edges) as num,view_edges optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_edges UNWIND range(0,num-1) as i delete views[i] with DISTINCT view_edge MATCH (acc:Account {id: \"7606696318861801\"})-[r:repay]->(loan: Loan {id: \"288346924384537\"}) where r.timestamp=\"1645739703489\" delete r",
    "MATCH (loan:Loan {id: \"569547023196251\"}) detach delete loan": "MATCH (loan:Loan {id: \"569547023196251\"}) WITH [loan] as delete_views  UNWIND delete_views as view_vetex optional match (n:Account)-[*0]-(view_vetex)-[r1*..2]->(m:Loan) WHERE ALL(rel IN r1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Account)-[r1*..2]->(m:Loan)-[*0]-(view_vetex) WHERE ALL(rel IN r1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Account)-[ANONR0*1]->(view_vetex)-[ANONR1*0..1]->(m:Loan) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Account)-[ANONR2*2]->(view_vetex)-[ANONR3*0]->(m:Loan) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:ACCOUNT_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Company)-[*0]-(view_vetex)-[r1]->()-[r2]->(m:Loan) WHERE r1.is_view is null  AND r2.is_view is null  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:COMPANY_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Company)-[r1]->()-[*0]-(view_vetex)-[r2]->(m:Loan) WHERE r1.is_view is null  AND r2.is_view is null  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:COMPANY_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Company)-[r1]->()-[r2]->(m:Loan)-[*0]-(view_vetex) WHERE r1.is_view is null  AND r2.is_view is null  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:COMPANY_LOAN{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Person)-[*0]-(view_vetex)-[r1*2]->(m:Company) WHERE ALL(rel IN r1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Person)-[r1*2]->(m:Company)-[*0]-(view_vetex) WHERE ALL(rel IN r1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Person)-[ANONR0*1]->(view_vetex)-[ANONR1*1..1]->(m:Company) WHERE ALL(rel IN ANONR0 WHERE rel.is_view is null)  AND ALL(rel IN ANONR1 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with view_vetexs UNWIND view_vetexs as view_vetex with DISTINCT view_vetex optional match (n:Person)-[ANONR2*2]->(view_vetex)-[ANONR3*0]->(m:Company) WHERE ALL(rel IN ANONR2 WHERE rel.is_view is null)  AND ALL(rel IN ANONR3 WHERE rel.is_view is null)  with n,m,collect(view_vetex) as view_vetexs with n,m,size(view_vetexs) as num,view_vetexs optional match (n)-[r:PERSON_COMPANY{is_view:true}]->(m) with collect(r) as views, n,m,num,view_vetexs UNWIND range(0,num-1) as i delete views[i] with DISTINCT view_vetex MATCH (loan:Loan {id: \"569547023196251\"}) detach delete loan"
}