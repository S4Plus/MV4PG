match (m:Place)<-[r1*2..2]-(n:Comment) where all(rel in r1 where rel.is_view is null) with n,m  CREATE (n)-[r:COMMENT_PLACE{is_view:true}]->(m)
MATCH (n:Person)-[r1]->()-[r2]->(m:Place) where r1.is_view is null and r2.is_view is null with n,m CREATE(n)-[r:PERSON_PLACE{is_view:true}]->(m)
match (n:Comment)-[r1:replyOf*..]->(m:Post) where all(rel in r1 where rel.is_view is null)  with n,m CREATE (n)-[r:ROOT_POST{is_view:true}]->(m)